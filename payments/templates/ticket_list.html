{% extends 'base.html' %}

{% load static %}

{% block title %}Available Tickets{% endblock %}

{% block content %}
<h1>Available Tickets</h1>
<ul class="list-group">
    {% for ticket in tickets %}
        <li class="list-group-item">
            <strong>Event:</strong> {{ ticket.event_name }} | 
            <strong>Date:</strong> {{ ticket.event_date }} | 
            <strong>Price:</strong> â‚¬{{ ticket.ticket_price }}

            <div class="float-end">
                {% if user.is_authenticated %}
                    {% if user == ticket.seller %}
                        <a href="{% url 'edit_ticket' ticket.pk %}" class="btn btn-warning btn-sm">Edit</a> 
                        <a href="{% url 'delete_ticket' ticket.pk %}" class="btn btn-danger btn-sm">Delete</a>
                    {% elif ticket.is_available %}
                        <stripe-buy-button
                            buy-button-id="buy_btn_1QAaarLdhgSQpHsXI9ZGK35c"
                            publishable-key="{{ STRIPE_PUBLISHABLE_KEY }}">
                        </stripe-buy-button>
                    {% endif %}
                {% endif %}
            </div>
        </li>
    {% empty %}
        <li class="list-group-item">No tickets available.</li>
    {% endfor %}
</ul>
{% endblock %}

{% block extra_js %}
<script async src="https://js.stripe.com/v3/buy-button.js"></script>
{% endblock %}
